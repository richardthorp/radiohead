{% extends 'base.html' %}
{% load static %}
{% block content %}
<div class="container content-container border">
    <h1 class="header-font page-header text-center">View Bag</h1>
    {% for item in bag_items %}
    <div class="row">
        <div class="col-12 col-md-4">
            <img src="{{ MEDIA_URL }}{{ item.product.image.url }}" class="w-100" alt="">
        </div>
        <div class="col-12 col-md-8">
            <!-- ALBUM INFO -->
            {% if item.type == 'album' %}
            <h3 class="header-font">{{ item.product.title }}</h3>
            {% if item.cd_count %}
            <form action="{% url 'update_bag' 'cd' item.product.id %}" method="POST" class="d-inline">
                {% csrf_token %}
                <label for="cd_quantity" class="mb-0">CD Quantity:</label>
                <input id="cd_quantity" name="quantity" type="number" min="1" max="99" value="{{ item.cd_count }}">
                <button type="submit" class="btn btn-dark btn-sm">UPDATE</button>
            </form>
            {% include 'includes/cd_modal.html' %}
            {% endif %}
            {% if item.vinyl_count %}
            <form action="{% url 'update_bag' 'vinyl' item.product.id %}" method="POST" class="d-inline">
                {% csrf_token %}
                <label for="vinyl_quantity" class="mb-0">Vinyl Quantity:</label>
                <input id="vinyl_quantity" name="quantity" type="number" min="1" max="99"
                    value="{{ item.vinyl_count }}">
                <button type="submit" class="btn btn-dark btn-sm">UPDATE</button>
            </form>
            {% include 'includes/vinyl_modal.html' %}
            {% endif %}
            {% endif %}
            <!-- SIZED ITEM INFO -->
            {% if item.type == 'sized' %}
            <h3 class="header-font">{{ item.product.name }}</h3>
            {% if item.small_count %}
            <form action="{% url 'update_bag' 'S' item.product.id %}" method="POST" class="d-inline">
                {% csrf_token %}
                <label for="small_quantity" class="mb-0">Small Quantity:</label>
                <input id="small_quantity" name="quantity" type="number" min="1" max="99"
                    value="{{ item.small_count }}">
                <button type="submit" class="btn btn-dark btn-sm">UPDATE</button>
            </form>
            {% include 'includes/size_small_modal.html' %}
            {% endif %}
            {% if item.medium_count %}
            <form action="{% url 'update_bag' 'M' item.product.id %}" method="POST" class="d-inline">
                {% csrf_token %}
                <label for="medium_quantity" class="mb-0">Medium Quantity:</label>
                <input id="medium_quantity" name="quantity" type="number" min="1" max="99"
                    value="{{ item.medium_count }}">
                <button type="submit" class="btn btn-dark btn-sm">UPDATE</button>
            </form>
            {% include 'includes/size_medium_modal.html' %}
            {% endif %}
            {% if item.large_count %}
            <form action="{% url 'update_bag' 'L' item.product.id %}" method="POST" class="d-inline">
                {% csrf_token %}
                <label for="large_quantity" class="mb-0">Large Quantity:</label>
                <input id="large_quantity" name="quantity" type="number" min="1" max="99"
                    value="{{ item.large_count }}">
                <button type="submit" class="btn btn-dark btn-sm">UPDATE</button>
            </form>
            {% include 'includes/size_large_modal.html' %}
            {% endif %}
            {% endif %}
            <!-- OTHER PRODUCT TYPE - NO FORMAT OR SIZES -->
            {% if not item.type %}
            <h3 class="header-font">{{ item.product.name }}</h3>
            <form action="{% url 'update_bag' 'other' item.product.id %}" method="POST" class="d-inline">
                {% csrf_token %}
                <label for="quantity" class="mb-0">Quantity:</label>
                <input id="quantity" name="quantity" type="number" min="1" max="99" value="{{ item.quantity }}">
                <button type="submit" class="btn btn-dark btn-sm">UPDATE</button>
            </form>
            {% include 'includes/other_modal.html' %}
            {% endif %}
            <p class="mt-2 text-right">Subtotal: £{{ item.item_total }}</p>
        </div>
    </div>
    <hr>
    {% endfor %}
    <div class="row">
        <div class="col-12 text-right">
            <h2 class="header-font">Total</h2>
            <p>£ {{total}}</p>
        </div>
    </div>
</div>
{% endblock %}
